% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/km_band.R
\name{make_km_band}
\alias{make_km_band}
\title{KM + Band Plot with Shared X-axis and Fixed Colors}
\usage{
make_km_band(
  km_plot,
  band_plot,
  data,
  xlab = "Age (Days)",
  heights = c(3, 0.34),
  pad_km = c(4, 6, 0, 6),
  pad_bn = c(0, 6, 4, 2),
  band_y = 3,
  wa_percentile = 0.9,
  ctrl_name = "WT",
  treat_name = "KO"
)
}
\arguments{
\item{km_plot}{A ggplot object representing the Kaplan–Meier survival curve.}

\item{band_plot}{A ggplot object for the band plot. If \code{NULL}, a placeholder
plot with "no significant interval" is created.}

\item{data}{Data frame containing at least columns \code{age}, \code{dead}, and \code{group}.}

\item{xlab}{Label for the x-axis (default \code{"Age (Days)"}).}

\item{heights}{Numeric vector of length 2 specifying relative heights of the
KM and band plots (default \code{c(3, 0.34)}).}

\item{pad_km}{Numeric vector of length 4 specifying plot margins (top, right, bottom, left)
for the KM pane (default \code{c(4, 6, 0, 6)}).}

\item{pad_bn}{Numeric vector of length 4 specifying plot margins (top, right, bottom, left)
for the band pane (default \code{c(0, 6, 4, 2)}).}

\item{band_y}{Y-axis location for the band plot annotation (default \code{3}).}

\item{wa_percentile}{Numeric between 0 and 1 specifying the survival percentile
used for the Wang–Allison p-value (default \code{0.90} for the 90th percentile).}

\item{ctrl_name}{Character string specifying the name of the control group (default \code{"WT"}).}

\item{treat_name}{Character string specifying the name of the treatment group (default \code{"KO"}).}
}
\value{
A \code{patchwork} object combining the KM plot and the band plot, with:
\itemize{
\item Kaplan–Meier survival curve in the top pane,
\item Band plot (or placeholder) in the bottom pane,
\item Log-rank and Wang–Allison p-values annotated on the KM plot.
}
}
\description{
Combines a Kaplan–Meier survival plot (\code{km_plot}) with a corresponding band plot
(\code{band_plot}) aligned on a shared x-axis. Control and treatment groups are
colored black and red, respectively. Automatically adds log-rank and
Wang–Allison (2004) p-values based on survival percentiles.
}
\details{
The function automatically extracts strata names from \code{km_plot$data} to lock colors:
black for control, red for treatment. The Wang–Allison p-value is computed using
a Fisher exact test at the specified survival percentile.
}
\examples{
library(survival)
library(ggplot2)

set.seed(123)
dat <- data.frame(
  age = runif(200, 1, 1500),
  dead = rbinom(200, 1, 0.4),
  group = sample(c("WT", "KO"), 200, replace = TRUE)
)

km_plot <- survminer::ggsurvplot(
  survfit(Surv(age, dead) ~ group, data = dat),
  data = dat,
  palette = c("black", "red"),
  risk.table = FALSE
)$plot

make_km_band(km_plot, band_plot = NULL, data = dat)

}
